=== Event Tickets with Ticket Scanner ===
Contributors: sasonikolov
Tags: event ticketing, party tickets, ticket scanner, redeem tickets, woocommerce, venue tickets
Requires PHP: 7.0
Stable tag: 2.5.7
Tested up to: 6.7
License: GPLv3
License URI: https://www.gnu.org/licenses/gpl-3.0.html

Selling event or party tickets, member entrance with any expiration date, multipass tickets, family tickets and more. Selling different kind of tickets and redeeming them was never so easy.
Sell tickets for your event or party with WooCommerce. Scan the tickets at the entrance. Optional design your own ticket look and feel.
You can scan the tickets of your customer from the QR code on their mobile devices or the printed PDF ticket.

== Description ==
Selling event or party tickets, member entrance with any expiration date, multipass tickets, family tickets and more. Selling different kind of tickets and redeeming them was never so easy.
Optional create your own ticket look and feel with the ticket designer. The built-in anti-double-redeem-protection protects you for fake tickets beeing used.
Use the built-in browser-based ticket scanner or your own ticket scanner. Hand out badges as PDF to your customers and much more.


https://youtu.be/uWSdKdOyn70

[Whats in for you](https://youtu.be/KKLp1Lwqj_U)

Sell tickets for your event or party and redeem the ticket at the entrance with the free Tickets with WooCommerce plugin, from the team behind the Serial Code Validator in WordPress.

You can make your tickets look unique by adding a banner, logo and background image. The same applies also for the event or party flyer.
You can offer event badges for your event. So your customer can wear them during the event. With the badge editor you can controll the look and fell.

The QR code on the ticket can be customized, so that you can use your own ticket scanner and software if needed.
Your third party solution can be informed once a ticket is redeemed by a webhook.
You can give other person access to your ticket scanner with Auth Token System.

https://youtu.be/KKLp1Lwqj_U

[Quick start video](https://youtu.be/KKLp1Lwqj_U)

This plugin makes it easy to sell tickets and redeem them at the event location entrance for you in-person or virtual events. It integrates easely with your WooCommerce products.

Install the plugin and set your products to be a event ticket product. That's it.

The plugin will generate a secure ticket number and add them to the mail to your clients. It will also generate a PDF with the ticket information and QR code. The built-in ticket scanner allows you and your team to redeem the tickets by scanning the QR-code. You can also use an external keyboard scanner by using the text input field on the ticket scanner page.

You can even import your own ticket numbers, but it will generate them also on the fly. The freedom is in your hands.

The best is to try it out. So many options. Don't be shy, give it a try - you have nothing to loose :D


**Shop:** Sell event and party tickets with your normal products. The plugin will create the ticket number on the fly or use unused ticket numbers from your ticket number list for each sold item.

**Validation of ticket numbers:** You customer can validate a ticket number on your page. The ticket number generator gives you a flexible pattern to generate ticket numbers upfront. You can also **import your existing codes**.

**Validation of tickets:** You customer will get a link to a detail page and a PDF for each sold ticket.

**Build your own stolen ticket number database:** Support your customer and yourself to protect stolen ticket numbers to be sold or used to others. Mark reported ticket numbers as stolen and let others check the ticket numbers with the ticket number validator.

**How can you setup the ticket numbers?**
The ticket numbers will be generated by the plugin automatically, if you do not set up ticket numbers upfront.
You can enter your ticket numbers within the WP admin area in the ticket number section (a new menu point in the wordpress amdin area).
You can generate your own ticket numbers manually using the ticket number generator or import existing ticket numbers.
And you are also able to add your own ticket numbers by just entering them to the generated ticket numbers below the ticket number generator.
If needed you can assign the ticket (numbers) to a list which helps you to organize the tickets. The ticket list need to be assigned to a WooCommerce product.
Create one or more ticket lists to use the WooCommerce functionality.
Create bundle products - determine how many ticket numbers should be created with the sale of one product.

**How the ticket number works**
You define your look and feel for your ticket numbers. The generated ticket numbers will be unique. After you are satisfied with the generated ticket numbers, you can start the adding step.
The ticket adding step will check if the ticket number is unique on the server before adding it.
If the ticket number exists already on the server, it will not be added.

= The ticket number generator provides a lot of features: =
- Ticket number prefix - you can enter a fixed prefix to each ticket number
- Length of ticket number
- Only letters
- Uppercase, Lowercase or both
- Exclusion of letters that are easy to missread (i,l,o,q,p)
- Delimiter possible: [None, -, :, SPACE] - you decide after how many letters within the ticket number
- CVV code generation (only numbers)

Yes, this is a fork of the serial code validator plugin. We decided to make it an own plugin out of it. So to add more and more features that are not related to serial codes but to event tickets.

== Features ==
At the bottom of this page you will find a complete list of all features.

https://youtu.be/ls_Lkf08n9I

* Sell event tickets as PDF with WooCommerce
* Single entrance, mulitpass, family pass, member card with expiration date and more
* Add QR, tickets, badges, additional PDF pages to the purchase order emails.
* Download PDF of ticket to print it as a badge for your customers
* Attach your own PDF to the ticket PDF (will be added as additional pages)
* Also for professional usage - use your QR and barcode scanner to verify the tickets
* WooCommerce product variants supported
* Generate flyer for your party or event
* Redeem event tickets at the entrance using the included ticket scanner page (mobile ready)
* Add ICS calendar file or a ticket to the purhcase email and ticket detail page
* Store WooCommerce orderid, itemid and productid to a ticket that was generated or used for a product sale
* You can now set a unique ticket number format for all WooCommerce product that are using a ticket number
* You can now set the ticket number format directly also on the WooCommerce product detail page if needed
* Use your codes to restrict purchases that allow a purchase of this product only if the buyer has a code for it (purchase allowance code)
* Add your own messages for the ticket number validation form for your customers
* Add your own message for the "product stolen" validation message
* Disable the validation form for not logged in wordpress user
* User can register to a ticket (with the wordpress user id if needed) after the ticket number is checked - this makes your code one-time usable
* Display registered user information of a ticket number during the validation if you need this
* One time check can have a maximum check amount based on ticket list or based on the global settings
* The user can be forwared (redirected) to an URL after the ticket number was checked - to show more details
* Webhooks - you can inform other systems about ticket redeemed status and validation steps
* Display assigned tickets to your user with a shortcode [sasoEventTickets_code]
* Add images to the ticket (header, background and Footer)
* Adopt font size for the PDF ticket
* Forcing responsive design for the ticket scanner for better experience
* Allow multiple redeem times for multi usage tickets
* Ticket badge designer for maximum control of the look and feel

== Technical Requirments ==
Wordpress, Woocommerce, php-curl, php-imagick

== GETTING STARTED ==

A Quick start is shown in this [video](https://vollstart.com/event-tickets-with-ticket-scanner/docs/#quickstart).
A good first start is to open the event ticket admin area and create a list first, if not already done or if you do not want to use the default ticket list.
Go to your WooCommerce product and activate the ticket sale option and set the list.
Check out all the possible options in the event ticket admin area to understand, how to tweak your usages of plugin.
Optional: Then add your ticket number by importing (add button at the ticket table) or assign the ticket list to your products.
Optional: If you need a validation form for your users, to check the ticket number, then please add the shortcode **[sasoEventTicketsValidator]** to a page.

= Steps to start =
- Go to the admin area and click on menu "Event Tickets".
- Click on button "Add" next to the heading "List".
- Go to your "ticket" product and set the option with in the product settings "Event Tickets"
*To scan the QR code of the sold tickets at the entrance:*
- Go to the admin area and click on menu "Event Tickets".
- Click on the button "Ticket Scanner" at the top area
- Scan tickets and redeem them

Try it out first, before you go Premium! ["Here you can find the premium plugin"](https://vollstart.com/event-tickets-with-ticket-scanner).

== Build your own Stolen products database ==
You can set the status of a ticket number to be marked as stolen. This way you can offer your customers a way to report a stolen product. Other buyers of used products can validate the ticket number on your website and will be notified with a "Product is stolen" warning.
This could increase sales and help reducing theft of your products.
The check behaviour will be like "inactive codes" but with the stolen message. You can change the stolen message within the options area of the serial code admin.

== Protection with CVV ==
You can set a code verification value (CVV) to protect your tickets. The validation check will ask the user to enter both for a valid check.
That way you increase the security of your ticket numbers and prevent stealing the numbers (If you are able hide the CVV on your packaging).
If you use a CVV on a ticket number, then the user will be asked to enter this CVV too during the validation. If the CVV on your ticket number is not set or empty it will be ignored and your customer is not asked for it.

== Woocommerce support for auto-generating tickets ==
**Supports version 6+**
**You can use this plugin to auto-generate tickets and codes for your woocommerce products**
* Create a code list
* Go to your WooCommerce product and edit the product which should receive a ticket
* Go to your WooCommerce product and edit the product which should receive a code - if needed
* Click on "Event Tickets" in the attribute area of your product
* Choose the "List" that will be used for this product

Everytime this product is sold, it will get a new generated ticket number/code or use an unused one within your list (This need to be activated within the option settings). The new code will be added to the code list you set on your WooCommerce product and to the product sale too.
If the sold product quantity in the order is more than 1, then a ticket number/code will be generated for each element. The code will be generated after the purchase. In case of a refund the code will be recovered and marked as unused, so that it can be reused.

*E.g.: Your customer bought 2 of the same product within one order, then 2 tickets will be generated and stored to the product item within this order.*

= WooCommerce Ticket Features =
* Automatically create and assign tickets for physical products and digital products
* Recover tickets assigned to refunded orders
* Option to reuse the recovered tickets with the latest orders
* Automatically deliver the tickets with the complete order email
* Automatically a ticket as PDF for download and add the download link to the complete order email.
* Automatically deliver the tickets and download URL with the optional PDF invoice "WooCommerce PDF Invoices"
* Download a flyer for your event or party

= WooCommerce Code Features =
* Automatically create and assign codes for physical products and digital products
* Recover code assigned to refunded orders
* Option to reuse the recovered codes with the latest orders
* Automatically deliver the codes with the complete order email
* Automatically deliver the codes with the optional PDF invoice "WooCommerce PDF Invoices"

**Please note:**
If you exceed your limit (*no limits for premium user*) of the amount of possible tickets/codes, then the ticket/code added to the sold product will be a text information: **"Please contact our support for the code"**.
This way your business is not harmed and your customer can contact you to get a code manually. The format of the code will be **12345-12345-12345-12345** if you do not set a generation format within the options.

== WooCommerce PDF Invoices support to display the ticket numbers on the PDFs ==
If you use ["WooCommerce PDF Invoices"](https://en-gb.wordpress.org/plugins/woocommerce-pdf-invoices-packing-slips/), then the generated ticket numbers/codes are displayed on the generated PDFs too!
The supported PDF plugin is from Ewout Fernhout.

== WooCommer Ticket Sale ==
You can add a list to your product and sell tickets. The ticket will be added to the sale informations for you and your client.
The client will also have a link to check the ticket and mark the ticket as used, only if the order is set to completed. This will mark the ticket as redeemed.
You can check the entrance by letting your customer show the confirmation page and hit on the "redeem"-button.
Or you scan the QR code of the ticket with the ticket scanner (included). The ticket is also available as PDF for download to your customers.
[Checkout the video, how it works](https://vollstart.com/event-tickets-with-ticket-scanner/docs/#ticket)

== Frontend ==
We have different frontend elements. Just to sell tickets and scan them, you do not need to add any shortcodes to your pages.

= Frontend event tickets =
Your customer will receive a specific URL to the ticket detail page. You can control which information to display. additional they can download the ticket as a PDF.
The ticket will contain a QR code, that can be scanned by you or your team (no loggin to WordPress needed) and redeem the ticket.
[Watch the video for it](https://vollstart.com/event-tickets-with-ticket-scanner/docs/#quickstart)

= Frontent to validate the ticket number =
* Use the shortcode **[sasoEventTicketsValidator]**
* Create a page or use an existing one and add the shortcode to the page
* The shortcode will be replaced for your users by a form to enter the ticket number and a button to validate the ticket. This allows you to surround the form with your own heading and instruction.
* Each ticket number has a display version (e.g. XYZXYZ -> XYZ-XYZ), so it is easier for your user to read the ticket number.
* The check will remove the display delimiter "-", ":", " " for the check automatically.
* So your user can enter the ticket number with or without delimiters.

If you use CVV on a code and the user enter the ticket number that requires a cvv, then your user will be ask to enter the CVV.
The user could enter the CVV immediately with the code. Separate the value with a ":". E.g: XYZXYZ:1234.

It is possible to prefill the ticket number validation form with a ticket number.
Add the parameter "code" to your page URL to create a link that prefills the form.
*E.g https://vollstart.com/serial-codes/?code=123-456-789*

= Form options for expert =
You can use your own input, trigger and output HTML element.
Add the id parameter to your HTML elements and pass them to the shortcode as corresponding parameter.
You can add also your own JS function name that will be called before the ticket number is checked on the server and also if the result comes back.
*[sasoEventTicketsValidator inputid="" triggerid="" outputid="" jspre="" jsafter=""]*
[Read here more about this feature](https://vollstart.com/event-tickets-with-ticket-scanner/docs/#styling)

== Quick overview ==
Each ticket number is unique. The list is for your organisation and for your WooCommerce products.

= Plugin administration - where to find the plugin management area =
*It will add a new menu entry "Event Tickets" within the settings section.*

[More about the plugin on our website](https://vollstart.com/event-tickets-with-ticket-scanner/docs)

== Support ==
Write to support@vollstart.com for support request.
For both plugins: The basic free and for the premium plugin.
We are here to help you.

== Premium Features ==
The **premium plugin** is now available with a lifetime license and 1 year support.

= Your benefits =
* Remove branding banner from ticket footer
* Unlimited ticket numbers (the basic allows you 50 tickets)
* Unlimited Lists
* Save IP address of user using the ticket number validation check on your page
* Block IPs after x retries within 60 minutes - prevent brute force
* One time usage overuled by list settings
* Enter expiration date for tickets
* Enter expiration date for ticket number lists (ticket number overrule list expiration date)
* Attach PDF tickets to the purchase email
* Assign tickets to existing WooCommerce orders
* See the redeemed ticket amount on the product detail view and on the ticket scanner
* Download the redeemed ticket logs
* Overwrite ticket banner, logo and background image on product level
* De- and re-activate ticket number
* **Security:** Block IPs after x retries within 60 minutes - prevent brute force
* User JS redirects on product level

**Checkout the premium plugin and planned features: [Event Tickets with WooCommerce Premium](https://vollstart.com/event-tickets-with-ticket-scanner/)**

== Installation ==

* WordPress 5.0 or greater
* PHP version 7.0 or greater
* MySQL version 5.0 or greater

= Installation =

1. Install the pluging using the WordPress built-in Plugin installer.
2. Activate the plugin through the 'Plugins' menu in WordPress.
3. Click on the menu "Event Tickets" and browse the options - optional.
4. Edit your product to generate a event ticket.

= Quick Setup =
This plugin extend WooCommerce to be able to setup your product as a ticket. Go to the product. Open the Event Tickets tab and activate the checkbox. Set the ticket list and fill out the other details if needed.
The default is to generate the ticket if the order is "completed". For automatically order status set to "completed" set up the ticket as a virtual product and/or download product - add a flyer or so as a download.
To test the ticket. Create an order within the order backend, set the order status to "completed" - this will assign the ticket numbers. Check the order email. Click on the ticket detail link to check the ticket detail page.
Create a real test purchase (with coupon code or wire transfer), check the order email.
If you have a 404 page for ticket detail page or ticket scanner page, then set up the compatibility options.

**For more help and your first steps, please [visit our website](https://vollstart.com/event-tickets-with-ticket-scanner/docs/)**

== Screenshots ==

1. **Ticket Details Mobile** The ticket details are also optimized for mobile devices.
2. **Ticket Details Desktop** You can define what will be shown on the ticket.
3. **Ticket PDF** Your customer can download the ticket as a PDF.
4. **Ticket scanner** Scan and redeem the tickets at the entrance on mobile and desktop devices.
5. **Ticket Badge** Print out your ticket badge with customer name on it.
6. **Options 1** Ticket options.
7. **Options 3** Created tickets backend admin area.
8. **Options 4** Ticket numbers can be pre generated if needed.
9. **Flyer example** You can also adjust your event or party flyer.
10. **Ticket example** You can adjust different areas of the PDF ticket.
11. **Product settings** You overwrite the format of the ticket number and activate the ticket sale.
12. **Options 5** Adjust the information on the flyer.
13. **Order Ticket Detail View** Quick ticket scan possible with the order ticket detail view.

== Upgrade Notice ==
= 2.0.5 =
Attention, the option wcTicketShowRedeemBtnOnTicket is added and replace the old wcTicketDontShowRedeemBtnOnTicket.
The template for the ticket designer is adjusted for this!
In the future the template code part with the buttons will be removed from the ticket designer.

= 1.3.0 =
Attention, the translation forced bigger chunk of code to be changed.

= 1.2.0 =
To update the old sold tickets, please execute the "repair table" button within the support area. From now on we will store also the user id of the ticket purchase.

= 1.0.11 =
Default value is changed to true for the option ro reuse not used tickeu39974   t numbers within a ticket list assigned to a product

= 1.0.9 =
New option to add the amount of purchased tickets per sold item on the PDF. Database updated. You can see now the redeemed ticket information within the admin area on the data table.

= 1.0.5 =
Serial code options are removed. They do not fit with the event and party tickets approach.

= 1.0.4 =
Activate in the options the new feature to attach the calendar entry (ICS file) to your purchase emails.

= 2.4.0 =
New Javascript library for the ticket scanner. If you need to use the old ticket scanner, then add the parameter &useoldticketscanner=1 to the ticket scanner URL.

= 2.4.1 =
New default value for the option to allow access to the admin area of the tickets - now it is false, only administrator, until you set it otherwise.

= 2.5.0 =
Default ticket template was adjusted. Plugin tested with PHP 8.3 - to use URLs in your template for the PDF make sure you have php8.3-curl and php8.3-imagick installed.

== Changelog ==
= 2.5.7 - 2025-02-17 =
* Option wcassignmentDoNotPutOnEmail is removed - makes no sense and was not used.
* Option wcassignmentDoNotPutOnPDF is removed - makes no sense and was not used.
* Replaced $_REQUEST with the $_POST or $_GET approach, in case the super globals are off.
* Option wcTicketCompatibilityUseURL to use the file location of an image for the PDF instead of the URL - some installations have issues with the firewall.
* You can now enter any public ticket number to test the ticket template design. So you can choose from the dropdown or enter the number in the textfield next to the dropdown.
* Date picker of the same cart item will update all empty date picker to the same date, to speed up entering the values.
* Add more error handling, if the order do not exists or is not assigned while reading the customer company name for the ticket list in the admin.

= 2.5.6 - 2025-02-03 =
* New column Billing Company for the ticket list within the plugin admin - option displayAdminAreaColumnBillingCompany
* Key check for error log, to prevent errors if the line is not available
* Support for daychooser to exclude specific dates, that were added with premium 1.4.4
* Fix the ugly display of the ticket information within the order for public ticket number and choosen days.
* Changed the default template to handle the string in product.get_attributes better
* Added new TWIG tests. object, array, string and numeric. You can use it like: {% if item is array %}.
* Ticket scanner is now checking the REST API result and parsing it to json in case your server sends the wrong content type.
* Add header_remove() before sending the PDF to prevent issues from other plugins.

= 2.5.5 - 2025-01-22 =
* Fix test template preview - using again the test template
* Adjusted default ticket template to display the variant names with a space

= 2.5.4 - 2025-01-20 =
* Some labels and description improvements on the option page
* Fixed output on the product detail to display the start and end date correctly
* Changed code to display the correct variant product date
* Added support for the day chooser on variable products
* Added more NONCE check to prevent CRFS issues
* Small fix for the event flyer layout

= 2.5.3 - 2025-01-14 =
* Add error handling if the product is missing during generation of the ticket PDF
* Improved the error messaging on the cart view for the day picker tickets
* New option to add input field, dropdown and date picker to the checkout page - wcTicketShowInputFieldsOnCheckoutPage
* Bug fix for the ticket scanner. The redeem until message is only shown if the date is also set.
* Removed the prefix OPTIONS from the option - effects only display options name
* Bug fix for badge PDF - the public ticket number is displayed correctly again

= 2.5.2 - 2025-01-03 =
* Bug fix for "expired" warning for tickets on the ticket scanner

= 2.5.1 - 2024-12-25 =
* Bug fix for attaching ICS file to the order mail
* Bug fix display woocommerce order date on PDF and ticket

= 2.5.0 - 2024-12-23 =
* Tested with PHP 8.3 - DO NOT RELY ON PHP8 yet if possible. To use URLs in your template for the PDF make sure you have php8.3-curl and php8.3-imagick installed.
* Add new feature Date Picker for tickets. You can now setup the product to have a start and end time and the day can be chosen by your customer at the cart view.
* Exclude days for the date picker on product level
* New label for the error message with the date picker - wcTicketLabelCartForDaychooser and wcTicketLabelCartForDaychooserInvalidDate
* Displaying the value per ticket, name per ticket and day chosen per ticket to the order email.
* Fix for label of the value chosen by the dropdown within the cart
* Adjusted the default ticket template to reflect the day choosen for date picker tickets.

= 2.4.4 - 2024-12-02 =
* Added french language file for the backend. Big thanks to Maxime.
* Remove HTML from the description of the auth token
* Remove HTML from the product id list of the auth token

= 2.4.3 - 2024-11-12 =
* On the badge the event date will not be shown if the value at the event is not set. {TICKET.PRODUCT.XYZ}. Properties are ticket_start_date, ticket_end_date, ticket_start_time and ticket_end_time
* New option to remove tickets from partially refunded order items - wcassignmentOrderItemRefund
* In order view, the public ticket ids are listed more easier to read
* Bug fix for additional ticket numbers to an order item. Now the values are corrected and the amount of tickets is correct.
* Bug fix for delete order - the tickets are removed now

= 2.4.2 - 2024-10-29 =
* Fix wrong error message, if you have no values selected in option adminAreaAllowedRoles.
* Fix default ordering over the created date if you display additional columns.
* Preventing and removing "/" from the ticket number formatter prefix value, because this can cause issues on some installations due to the database search. The "/" will be replaced by "-".
* Redeemable from info at the ticket scanner only displayed if the option wcTicketDontAllowRedeemTicketBeforeStart is activated.
* Ticket scanner is not rescanning the same ticket for 10 seconds - this prevents double redeem operation in fast mode.
* Removed most of the time calculation at the ticket scanner and using calculated times from the server
* New label for the status "Event ended already" - wcTicketTransTicketNotValidToLateEndEvent
* Default label value changed from "Redeemed at:" to "Last Redeemed:" - wcTicketTransRedeemDate
* Fix of some misleading redeem messages. It is now more clear, if the ticket expired, the event did not start yet and it is too late to redeem the ticket.

= 2.4.1 - 2024-10-21 =
* Rework the whole date calculation - again. I hope this time for the last time - tested in Manila and Zurich.
* New option to display server time and local time to the ticket scanner - option ticketScannerDisplayTimes.
* Optimize JS file including and added loading the translation to the order detail script.
* Added the functionality to have the order detail view translated.
* New column "confirmed count" added to the admin area - option displayAdminAreaColumnConfirmedCount to show it.
* New default values for the ticket number formatter if not set at all - 21 letter, use also numbers and delimiter with "-" after 7 letters - this makes sure you have enough ticket numbers for the future.
* New default value for option allowOnlySepcificRoleAccessToAdmin - it was set to false and allowed everyone with access to the backend access to the ticket admin.

= 2.4.0 - 2024-09-25 =
* New option for the QR code. You can now add a padding, to separate the QR code image from a background on your PDF - qrTicketPDFPadding
* New ticket scanner library - if you want to use the old scanner, then you can add the URL parameter &useoldticketscanner=1 to the ticket scanner URL
* Increase the speed of the old ticket scanner - just in case
* Moved the video help link to the option title and more helper videos added
